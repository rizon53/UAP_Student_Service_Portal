{% extends 'base.html' %}
{% load routine_extras %}

{% block content %}
<style>
    .routine-container {
        background: rgba(15, 15, 30, 0.9);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 0 30px rgba(0, 198, 255, 0.3);
        backdrop-filter: blur(10px);
        margin-top: 50px;
        color: #fff;
    }

    h2 {
        color: #00c6ff;
        text-shadow: 0 0 10px rgba(0,198,255,0.8);
        font-weight: 700;
    }

    .form-select, .btn {
        border-radius: 10px;
        font-weight: 500;
    }

    .btn-primary {
        background: linear-gradient(90deg, #00c6ff, #0072ff);
        border: none;
        box-shadow: 0 0 10px #00c6ff, 0 0 20px #0072ff;
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        box-shadow: 0 0 20px #00c6ff, 0 0 40px #0072ff;
        transform: translateY(-2px);
    }

    .btn-outline-primary {
        border: 2px solid #00c6ff;
        color: #00c6ff;
        background: transparent;
        font-weight: 600;
        transition: 0.3s;
    }

    .btn-outline-primary:hover {
        background: linear-gradient(90deg, #00c6ff, #0072ff);
        color: #fff;
        box-shadow: 0 0 15px #00c6ff;
        transform: scale(1.05);
    }

    .img-thumbnail {
        border: 2px solid #00c6ff;
        box-shadow: 0 0 20px rgba(0,198,255,0.3);
        border-radius: 15px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .img-thumbnail:hover {
        transform: scale(1.03);
        box-shadow: 0 0 25px rgba(0,198,255,0.6);
    }

    .text-muted {
        color: rgba(255,255,255,0.7) !important;
    }

    /* Optional glowing border animation */
    @keyframes glowBorder {
        0% { box-shadow: 0 0 10px #00c6ff; }
        50% { box-shadow: 0 0 25px #0072ff; }
        100% { box-shadow: 0 0 10px #00c6ff; }
    }

    .routine-container:hover {
        animation: glowBorder 2s infinite alternate;
    }
</style>

<div class="container routine-container">
    <h2 class="mb-4 text-center">ðŸ“˜ View Class Routine</h2>

    <!-- Select Department & Year -->
    <form method="get" class="row g-2 mb-4 justify-content-center">
        <div class="col-md-3">
            <select name="department" class="form-select">
                <option value="">Select Department</option>
                {% for code, name in departments %}
                    <option value="{{ code }}" {% if selected_dept == code %}selected{% endif %}>{{ name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-3">
            <select name="year" class="form-select">
                <option value="">Select Year</option>
                {% for code, name in years %}
                    <option value="{{ code }}" {% if selected_year == code %}selected{% endif %}>{{ name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2 text-center">
            <button type="submit" class="btn btn-primary w-100">View Routine</button>
        </div>
    </form>

    <!-- Routine Display -->
    {% if routines %}
        <div class="row justify-content-center">
            {% for r in routines %}
                <div class="col-md-5 mb-4 text-center">
                    {% if r.routine_file.url|endswith:".pdf" %}
                        <a href="{{ r.routine_file.url }}" target="_blank" class="btn btn-outline-primary">
                            ðŸ“„ View PDF: {{ r.title|default:"Routine" }}
                        </a>
                    {% else %}
                        <img src="{{ r.routine_file.url }}" alt="{{ r.title|default:"Routine" }}" class="img-thumbnail">
                        <p class="mt-2">{{ r.title|default:"Routine" }}</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-center text-muted">No routine uploaded for this selection.</p>
    {% endif %}
</div>
{% endblock %}